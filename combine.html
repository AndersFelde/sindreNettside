<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        .ad-card {
            width: 18rem;
            margin: 0 2% 0 2%;
        }

        .quiz-question-flex {
            margin-top: 1%;
        }

        .question-title {}

        .question-text {
            line-height: 1.5rem;
            height: 4rem;
        }

        .question-thumbnail {
            width: 20%;
        }

        #question-body {
            padding: 1.5rem
        }

        .question-content {
            margin-top: 5%;
        }

        .inline-icon {
            vertical-align: bottom;
            font-size: 19px !important;
        }


        .progress-div {
            width: 30rem;
            display: block;
            margin: 3rem auto 0 auto;
            text-align: center;
        }

        .shadow-lg,
        .shadow {
            border-radius: 2.25em !important;
        }

        .quiz-card {
            border-radius: 2.25em !important;
        }
    </style>

</head>

<body>
    <div id="question-div">
        <div style="width: 100%;">

            <div class="progress-div">
                <p id="question-count">Spørsmål <span id="question-current">1</span>/<span id="question-total">10</span>
                </p>
                <div class="progress">
                    <div class="progress-bar" id="questionProgress" role="progressbar" style="width: 0%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
            <div class="quiz-question-flex d-flex justify-content-center ">
                <div class="shadow-lg bg-body rounded">
                    <div class="card quiz-card" style="width: 30rem;">
                        <img style="display:block; margin:auto; width:40%;bottom: 0;" id="question-image" src="icons/farger/oversikt.png" class="card-img-top" alt="...">
                        <div class="card-body">
                            <div id="question-body" style="padding: 0 1.5rem 1.5rem 1.5rem" class="d-flex flex-column justify-content-center align-items-center shadow">
                                <!-- <img class="question-thumbnail question-content" style="width: 10%" src="https://www.pngkit.com/png/detail/296-2967118_conclusion-finance-icon.png"> -->
                                <h5 id="question-type" class="card-title question-title ">Generasjonsplanlegging</h5>
                                <p id="question-text" class="card-text text-center question-text question-content">Har
                                    du en klar plan for hvordan verdiene skal videreføres til neste generasjon?</p>
                                <div class="w-75 question-content card-text d-flex justify-content-between">
                                    <!-- <div class="answer-yes"> -->
                                    <button onclick="nextQuestion(0)" id="no-button" type="button" class="btn btn-danger">
                                        <span class="inline-icon material-icons">
                                            west
                                        </span>
                                        Nei
                                    </button>
                                    <!-- </div> -->
                                    <!--                           BUG: Skip er egt samme som å svare nei       -->
                                    <button type="button" onclick="nextQuestion(0)" class="btn btn-secondary">Skip</button>
                                    <button onclick="nextQuestion(1)" id="yes-button" type="button" class="btn btn-success">
                                        <!-- <div class="answer-no"> -->
                                        Ja
                                        <span class="inline-icon material-icons">
                                            east
                                        </span>

                                        <!-- </div> -->
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
    </script>

    <div style="display:none;" id="chart-div">
        <div style="width:100%;margin-top: 3rem;">
            <div class="d-flex justify-content-center">
                <div><canvas id="pieChart"></canvas></div>
                <div class="w-25 d-flex justify-content-center align-items-center">
                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been
                        the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley
                        of type and scrambled </p>
                </div>
            </div>
            <div style="width:50%;margin:5% auto 0 auto;"><canvas id="barChart"></canvas></div>
            <div class="container-fluid " style="overflow-x:auto; margin-top: 5%; width: 80%">
                <div class="row flex-row flex-nowrap">
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                    <div class="card ad-card">
                        <img src="https://assets.unenvironment.org/2021-01/Finance.png?VersionId=null" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">Some quick example text to build on the card title and make up the bulk
                                of the card's content.</p>
                            <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        //questions = ["Økonomi spørsmål 1", "Familie spørsmål 1", "Barn spørsmål", "Økoonomi spørsmål 2", "Barn spørsmål 2"];
        questions = ["Har du 100% oversikt over alle dine verdier",
            "Føler du deg ivaretatt og fulgt opp på en god måte der du har pengene din idag?",
            "Har du tatt riktige valg for hvor mye penger du skal ha på bankkonto, i eiendom og i investeringer som kan gi bedre avkastning?",
            "Har du lånt riktig mengde penger i forhold til inntekt og verdier?",
            "Har du en klar plan for hvordan verdiene skal videreføres til neste generasjon?",
            "Har du utarbeidet viktige dokumenter som dine nærmeste trenger hvis det skulle hende deg noe? (testament, fremtidsfullmakt, mm.)",
            "Har du en investeringsstrategi for pengene dine som er tilpasset dine mål? ",
            "Vet du hvilken påvirkning investeringene din har på viktige områder som miljø, menneskerettigheter og korrupsjon?",
            "Er formuen din best mulig organisert med tanke på skatt?",
            "Har du verdier for over 1 million kroner? (Eiendom, bank og investeringer)"
        ]

        //questionTypes = ["okonomi", "familie", "barn", "okonomi", "barn"];
        questionTypes = ["oversikt", "oppfolging", "riktig_investert", "lan", "generasjonsplanlegging", "viktige_dokumenter", "investerings_teknologi", "barekraft", "skatt", "total"]
        questionTypesNice = ["Oversikt", "Oppfølgning", "Riktig investert?", "Lån", "Generasjonsplanlegging", "Viktige dokumenter", "Investeringer", "Bærekraft", "Skatt", "Totalt"]

        types = {}
        for (var i = 0; i < questionTypes.length; i++) {
            types[questionTypes] = 0
        }

        answers = [];
        counter = 0;

        qCount = 0;
        qTotal = questions.length;
        qPercentage = 100 / qTotal;

        questionText = document.querySelector("#question-text");
        questionImage = document.querySelector("#question-image");
        questionType = document.querySelector("#question-type");
        progressBar = document.querySelector("#questionProgress");
        qCountElm = document.querySelector("#question-current");
        qTotalElm = document.querySelector("#question-total");
        qTotalElm.innerHTML = qTotal;

        yesButton = document.querySelector("#yes-button");
        noButton = document.querySelector("#no-button");





        updateCount()
        loadQuestion()

        function nextQuestion(a) {
            console.log(a);
            if (qCount <= qTotal) {
                answers[qCount - 1] = parseInt(a);
                types[questionTypes[qCount - 1]] += parseInt(a);
                if (qCount == qTotal) {
                    finish()
                } else {
                    updateCount()
                    loadQuestion()
                }
            }
            console.log(questions);
            console.log(answers);
            console.log(types);

        }

        function finish() {
            //sessionStorage.setItem("questions", questions);
            //sessionStorage.setItem("answers", answers);
            //sessionStorage.setItem("types", JSON.stringify(types));

            if (answers[answers.length - 1] == 1) {
                alert("Du blir satt over til alphaspar")
            } else {
                alert("Du er ferdig")
            }
            document.querySelector("#question-div").style.display = "none"
            document.querySelector("#chart-div").style.display = "block"
            drawChart()
        }

        function loadQuestion() {
            questionText.innerHTML = questions[qCount - 1];
            questionType.innerHTML = questionTypesNice[qCount - 1];
            questionImage.src = "icons/farger/" + questionTypes[qCount - 1] + ".png"
        }

        function updateCount() {
            qCount++;
            qCountElm.innerHTML = qCount;
            currentPercent = qPercentage * (qCount - 1)
            addingPercentage = qPercentage / 10;
            updateProgress(0, currentPercent, addingPercentage)
        }

        function updateProgress(i, currentPercent, addingPercentage) { //  create a loop function
            setTimeout(function() { //  call a 3s setTimeout when the loop is called
                progressBar.style = "width: " + String(currentPercent + addingPercentage * i) + "%";
                i++;
                setTimeout(function() {}, 500);
                if (i < 10) { //  if the counter < 10, call the loop function
                    updateProgress(i, currentPercent, addingPercentage)
                } else if (qCount == qTotal) {
                    progressBar.style = "width: 100%"

                }


            }, 20)
        }
        //types = JSON.parse(sessionStorage.getItem("types"))

        function drawChart() {
            labelsNew = []
            dataNew = []
            for (var i = 0; i < answers.length; i++) {
                if (answers[i] == 1) {
                    dataNew.push(1)
                    labelsNew.push(questionTypesNice[i])
                }


            }
            //types = JSON.parse(sessionStorage.getItem("types"))
            const data = {
                labels: labelsNew,
                datasets: [{
                    label: 'Dine resultater',
                    data: dataNew,
                    backgroundColor: [
                        "#003f5c",
                        "#2f4b7c",
                        "#665191",
                        "#a05195",
                        "#d45087",
                        "#f95d6a",
                        "#ff7c43",
                        "#ffa600",
                        'rgb(255, 99, 132)',
                        'rgb(255, 205, 86)'
                    ],
                    //backgroundColor: [
                    //'rgb(255, 99, 132)',
                    //'rgb(54, 162, 235)',
                    //'rgb(255, 205, 86)'
                    //],
                    hoverOffset: 4
                }]
            };

            const config = {
                type: 'doughnut',
                data: data,
            };

            var pieChart = new Chart(
                document.getElementById('pieChart'),
                config
            );


            const labels = ["Økonomi", "Familie", "Barn"]
            const data1 = {
                labels: labels,
                datasets: [{
                    label: 'Dine svar',
                    data: [types["okonomi"], types["familie"], types["barn"]],
                    backgroundColor: [
                        'rgb(255, 99, 132)',
                        'rgb(54, 162, 235)',
                        'rgb(255, 205, 86)'
                    ],
                    borderColor: [
                        'rgb(255, 99, 132)',
                        'rgb(54, 162, 235)',
                        'rgb(255, 205, 86)'
                    ],
                    borderWidth: 1,
                    borderRadius: 000,
                    borderSkipped: false,

                }]
            };
            const config1 = {
                type: 'bar',
                data: data1,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                },
            };
            var barChart = new Chart(
                document.getElementById('barChart'),
                config1
            );
        }
    </script>




</body>
